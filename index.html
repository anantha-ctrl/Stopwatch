<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stopwatch Web App</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to right, #667eea, #764ba2);
      font-family: 'Poppins', sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    .stopwatch {
      max-width: 500px;
      margin: 60px auto;
      padding: 30px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    .time {
      font-size: 3rem;
      font-weight: bold;
      letter-spacing: 2px;
    }
    .lap-item {
      background: #f3f4f6;
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 8px;
    }
    footer {
      margin-top: auto;
      background: #1f2937;
      color: #d1d5db;
      text-align: center;
      padding: 15px 10px;
      font-size: 0.9rem;
    }
    footer a {
      color: #60a5fa;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="stopwatch text-center">
    <h2 class="mb-4 text-2xl font-bold text-gray-700">⏱ Stopwatch</h2>
    <div id="display" class="time mb-4 text-gray-900">00:00:00.000</div>
    
    <!-- Control Buttons -->
    <div class="d-flex flex-wrap justify-content-center gap-3 mb-4">
      <button id="startBtn" class="btn btn-success rounded-pill px-4">Start</button>
      <button id="pauseBtn" class="btn btn-warning rounded-pill px-4">Pause</button>
      <button id="resetBtn" class="btn btn-danger rounded-pill px-4">Reset</button>
      <button id="lapBtn" class="btn btn-info rounded-pill px-4">Lap</button>
      <button id="clearLapsBtn" class="btn btn-secondary rounded-pill px-4">Clear Laps</button>
      <button id="downloadBtn" class="btn btn-primary rounded-pill px-4">Download Laps</button>
    </div>

    <!-- Lap Times -->
    <h4 class="text-lg font-semibold text-gray-700 mb-2">Lap Times</h4>
    <div id="laps" class="text-start"></div>
  </div>

  <!-- Footer -->
  <footer>
    <p>© 2025 Stopwatch App | Designed & Developed by 
      <a href="https://github.com/anantha-ctrl/" target="_blank">Anantha Kumar G</a>.
    </p>
  </footer>

  <script>
    let timer;
    let isRunning = false;
    let elapsedTime = 0;
    let lapCount = 0;
    let lapRecords = [];

    const display = document.getElementById("display");
    const laps = document.getElementById("laps");
    const startBtn = document.getElementById("startBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");
    const lapBtn = document.getElementById("lapBtn");
    const clearLapsBtn = document.getElementById("clearLapsBtn");
    const downloadBtn = document.getElementById("downloadBtn");

    function formatTime(ms) {
      const totalSeconds = Math.floor(ms / 1000);
      const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, "0");
      const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, "0");
      const seconds = String(totalSeconds % 60).padStart(2, "0");
      const milliseconds = String(ms % 1000).padStart(3, "0");
      return `${hours}:${minutes}:${seconds}.${milliseconds}`;
    }

    function updateDisplay() {
      display.textContent = formatTime(elapsedTime);
    }

    startBtn.addEventListener("click", () => {
      if (!isRunning) {
        isRunning = true;
        const startTime = Date.now() - elapsedTime;
        timer = setInterval(() => {
          elapsedTime = Date.now() - startTime;
          updateDisplay();
        }, 10);
      }
    });

    pauseBtn.addEventListener("click", () => {
      if (isRunning) {
        clearInterval(timer);
        isRunning = false;
      }
    });

    resetBtn.addEventListener("click", () => {
      clearInterval(timer);
      isRunning = false;
      elapsedTime = 0;
      lapCount = 0;
      lapRecords = [];
      updateDisplay();
      laps.innerHTML = "";
    });

    lapBtn.addEventListener("click", () => {
      if (isRunning) {
        lapCount++;
        const formattedTime = formatTime(elapsedTime);
        lapRecords.push(`Lap ${lapCount}: ${formattedTime}`);

        const lapTime = document.createElement("div");
        lapTime.className = "lap-item";
        lapTime.textContent = `Lap ${lapCount}: ${formattedTime}`;
        laps.prepend(lapTime);
      }
    });

    clearLapsBtn.addEventListener("click", () => {
      laps.innerHTML = "";
      lapCount = 0;
      lapRecords = [];
    });

    downloadBtn.addEventListener("click", () => {
      if (lapRecords.length === 0) {
        alert("No lap times to download!");
        return;
      }
      const blob = new Blob([lapRecords.join("\n")], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "lap_times.txt";
      link.click();
    });

    // Initialize display
    updateDisplay();
  </script>
</body>
</html>
